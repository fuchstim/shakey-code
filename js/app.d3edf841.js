(function(e){function t(t){for(var a,i,c=t[0],s=t[1],o=t[2],h=0,u=[];h<c.length;h++)i=c[h],Object.prototype.hasOwnProperty.call(A,i)&&A[i]&&u.push(A[i][0]),A[i]=0;for(a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a]);l&&l(t);while(u.length)u.shift()();return r.push.apply(r,o||[]),n()}function n(){for(var e,t=0;t<r.length;t++){for(var n=r[t],a=!0,c=1;c<n.length;c++){var s=n[c];0!==A[s]&&(a=!1)}a&&(r.splice(t--,1),e=i(i.s=n[0]))}return e}var a={},A={app:0},r=[];function i(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=a,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)i.d(n,a,function(t){return e[t]}.bind(null,a));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/shakey-code/";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],s=c.push.bind(c);c.push=t,c=c.slice();for(var o=0;o<c.length;o++)t(c[o]);var l=s;r.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"034f":function(e,t,n){"use strict";n("85ec")},"07d4":function(e,t,n){"use strict";function a(e,t){const n={};e.scan(0,0,e.bitmap.width,e.bitmap.height,(a,A)=>{const r=e.getPixelColour(a,A),{colour:i}=t.findClosestBitColour(r),c=t.calculateColourDistance(r,i);c<2e4&&(n[i]=(n[i]||0)+1)});const a=Object.entries(n).sort(([,e],[,t])=>e-t).pop();return a&&Number(a[0])}function A(e,t){const n=e.clone();return n.scan(0,0,n.bitmap.width,n.bitmap.height,(e,a)=>{const A=n.getPixelColour(e,a),{colour:r}=t.findClosestBitColour(A),i=t.calculateColourDistance(A,r);i>2e4?n.setPixelColour(0,e,a):n.setPixelColour(r,e,a)}),n}t["a"]={filterPrimaryBitColour:a,filterBitColours:A}},"0ac7":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABoAAAAaCAYAAACpSkzOAAAAAXNSR0IArs4c6QAAAfxJREFUSEutlr1OwzAQx89EIF4ChiKEusHUiGfo2DIi3oGBATFFDAy8A3NbmMoroHYCFmiF6FB4iUokRuf4krPzYafqLW0S+3735X8ioIm1OhIWU+HcUrLOvYm84uabCUAUQgbDe2QUQNk6AGgEkt8TEA+QwtAQTMbuyQsAccACWgeEfhWsxjYC4hB0aIPj8wSCw9O8vDogv9JR3fUmAvCkMIAMbJVNBeOcIFzAQBxycnWvtr/eXapy4jO89zYamm4XU9EIRBACyCSB96fHfDCiEI57/RRkDYo3CCcOjSAUchLHsBUEKit6tj5Ilw9hHITOyXCcKRg12nz8o7BBj1jVsTyqL+QQoBqC+7xArY6U7X2jucH8F+Kvl8IcqazYWtEbZEqS9qhMSuxpG50ZjsXH0rjeEQJW7T11b3u2hD8SJy1Ngo9uJi3kgk+OLoGdHaftzn7U5UrKigPLMyLnqF38v/aIoKOxdU4AYN7tg/hcmgDya5wj6/Sr7EpE0xtkqXh+jvDB9QTgVo8mH09dNvzZDMjuDUk/a4QTVOajIEEe5asDZfGMB/mrRL8oixLEB6NwUtLSOc0LRF5sxe6a54jD1LTVWa16O0CGc48Plmr15v2KTGnB4MXz0E/5daZuEH312L3zyMIob2VpKz6bnINQsaA+I9zUMPKqQP4B3LkjinGnCIMAAAAASUVORK5CYIIA"},1:function(e,t){},"10c9":function(e,t){e.exports="data:image/png;base64,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"},"1ac3":function(e,t,n){"use strict";n("d174")},2:function(e,t){},"242d":function(e,t,n){},2616:function(e,t,n){"use strict";n("90dc")},"39c7":function(e,t,n){"use strict";(function(e){var a=n("ef21"),A=n.n(a),r=n("07d4"),i=n("3c62"),c=n("c45a");class s{constructor({drawDebug:e,onSampleRecorded:t,onResult:n,sampleCount:a}={}){this._drawDebug=e,this.onSampleRecorded=t||(()=>{}),this.onResult=n||(()=>{}),this.sampleCount=a||3,this.tailPattern=new i["a"]({drawDebug:e=>this.drawDebug(e),pattern:[[{length:3,value:1},{length:2,value:0},{length:1,value:1},{length:2,value:0},{length:3,value:1}],[{length:1,value:0},{length:1,value:1},{length:3,value:0},{length:1,value:1},{length:3,value:0},{length:2,value:1}],[{length:1,value:0},{length:1,value:1},{length:1,value:0},{length:3,value:1},{length:3,value:0},{length:2,value:1}],[{length:1,value:0},{length:3,value:1},{length:2,value:0},{length:5,value:1}],[{length:2,value:0},{length:1,value:1},{length:3,value:0},{length:1,value:1},{length:3,value:0},{length:1,value:1}]]}),this.colourEncoder=new c["a"].ColourEncoder,this.samples=[]}async decode(t){if(!t.length)return;const n=await A.a.read(e.from(t,"base64")),a=this._findTailPattern(n);if(!a)return;const r=this._cropCode(n,a),i=this._parseCode(r);if(this._recordSample(i),this.samples.length>=this.sampleCount)try{const e=this.colourEncoder.decode(this.samples[0]);this.onResult.apply(this.onResult,[e])}catch(c){this.samples=[],console.error(c)}}_findTailPattern(e){const t=this.tailPattern.findCandidates(e);return t[0]}_cropCode(e,t){const n=7/11,a=1.4,A={x:t.x+t.width,y:t.y-(t.height*a-t.height)/2,width:Math.ceil(t.width*n),height:Math.ceil(t.height*a)},r=e.clone().crop(A.x,A.y,A.width,A.height);return r}_parseCode(e){const t=7,n=Math.round(e.bitmap.height/t),a=Math.round(e.bitmap.width/t),A=[];for(let i=1;i<t-1;i++){const c=i*a;for(let i=1;i<t-1;i++){const t=i*a,s=r["a"].filterPrimaryBitColour(e.clone().crop(t,c,a,n),this.colourEncoder);A.push(s)}}return A}_recordSample(e){this._compareSample(this.samples[0],e)?this.samples.push(e):this.samples=[e],this.onSampleRecorded.apply(this.onSampleRecorded,[{bits:e,samples:this.samples,sampleProgress:Math.min(Math.round(100*this.samples.length/this.sampleCount),100)}])}_compareSample(e,t){return!(!e||!t)&&e.every((e,n)=>e===t[n])}async drawDebug(e){await Object.entries(e).reduce(async(e,[t,n])=>{await e,this._drawDebug(t,{width:n.bitmap.width,height:n.bitmap.height,data:await n.getBase64Async("image/png")})},Promise.resolve())}}t["a"]=s}).call(this,n("b639").Buffer)},"3c62":function(e,t,n){"use strict";var a=n("ef21"),A=n.n(a);const r=A.a.rgbaToInt(0,0,0,255),i=A.a.rgbaToInt(255,255,255,255);class c{constructor(e){this.pattern=e.pattern,this.lightDarkCutoff=e.lightDarkCutoff||A.a.rgbaToInt(10,10,10,255),this.drawDebug=e.drawDebug,this.accuracy=e.accuracy||.5,this.patternMatchThreshold=e.patternMatchThreshold||this.accuracy,this.minSegmentLength=e.minSegmentLength||5}findCandidates(e){const t=this._findOutlines(e),n=this._getLineSequences(t),a=this._findCandidatesWithLineSequences(n),A=a.map(e=>({...e,matchScore:this._calculateCandidateMatchScore(t,e)})),r=A.filter(({matchScore:e})=>e>=this.patternMatchThreshold).sort((e,t)=>t.matchScore-e.matchScore);return r}_findOutlines(e){const t=e.clone();return t.greyscale().contrast(.1).scan(0,0,t.bitmap.width,t.bitmap.height,(e,n)=>{t.getPixelColour(e,n)>=this.lightDarkCutoff?t.setPixelColour(i,e,n):t.setPixelColour(r,e,n)}),t}_getLineSequences(e){const t=[];for(let a=1;a<=e.bitmap.height;a++){t[a]=[];let n={x:0,y:a,value:e.getPixelColour(1,a)===r?1:0,length:0};for(let A=1;A<=e.bitmap.width;A++){const i=e.getPixelColour(A,a)===r?1:0;n.value===i?n.length++:(n.length>=this.minSegmentLength&&t[a].push(n),n={x:A,y:a,value:i,length:1})}n.length>=this.minSegmentLength&&t[a].push(n)}const n=this._deduplicateSequences(t);return n.map(e=>this._calculateRelativeSegmentLengths(e))}_findCandidatesWithLineSequences(e){const t=[];return e.forEach(e=>{e.forEach((n,a)=>{const A=t.some(({x:e,y:t,width:a,height:A})=>{const r=n.x>=e&&n.x<=e+a,i=n.y>=t&&n.y<=t+A;return r&&i});if(A)return;const r=this.pattern[0],i=e.slice(a,a+r.length),c=this._compareSequences(r,i);if(!c)return;const s=r.reduce((e,{length:t})=>e+t,0),o=i.reduce((e,{length:t})=>e+t,0),l=Math.round(o/s),h=this.pattern.length*l;t.push({x:n.x,y:n.y,scale:l,width:o,height:h})})}),t}_calculateRelativeSegmentLengths(e){const t=e.map(({length:e})=>Number(e)).sort((e,t)=>e-t),n=t[0],a=t.filter(e=>e>=n*this.accuracy&&e<=n*(2-this.accuracy)),A=a.reduce((e,t)=>e+t,0)/a.length,r=e.map(e=>({...e,relativeLength:e.length/A}));return r}_trimSequence(e){return e.slice(0===e[0].value?1:0,0===e[e.length-1].value?e.length-1:e.length)}_compareSequences(e,t){const n=this._trimSequence(e).map(({value:e})=>e),a=this._trimSequence(t).map(({value:e})=>e);if(n.length!==a.length)return!1;for(let i=0;i<n.length;i++)if(n[i]!==a[i])return!1;const A=this._calculateRelativeSegmentLengths(e).map(({relativeLength:e})=>e),r=this._calculateRelativeSegmentLengths(t).map(({relativeLength:e})=>e);for(let i=0;i<A.length;i++){const e=A[i],t=r[i];if(e<t*this.accuracy||e>t*(2-this.accuracy))return!1}return!0}_deduplicateSequences(e){const t=[],n=e.reduce((e,n)=>{if(!e.length)return t.push(0),[n];const a=this._compareSequences(n,e[e.length-1]);return a?t[t.length-1]+=1:(t[t.length-1]<1&&(e.pop(),t.pop()),t.push(0),e.push(n)),e},[]);return n}_calculateCandidateMatchScore(e,t){const n=e.clone().crop(t.x,t.y,t.width,t.height),a=this._getLineSequences(n),A=this.pattern,r=Math.min(a.length,A.length),i=Array(r).fill().map((e,t)=>{const n=a[t],r=A[t],i=this._compareSequences(n,r);return{candidateLineSequence:n,patternLineSequence:r,match:i}}),c=Math.round(100*i.filter(({match:e})=>e).length/i.length)/100;return c}}t["a"]=c},"56d7":function(e,t,n){"use strict";n.r(t);var a=n("2b0e"),A=n("8c4f"),r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("h1",{staticClass:"title"},[e._v(" Encode ")]),n("p",{staticClass:"label"},[e._v(" Input code here: ")]),n("input",{directives:[{name:"model",rawName:"v-model",value:e.input,expression:"input"}],staticClass:"code",attrs:{type:"text",autofocus:""},domProps:{value:e.input},on:{input:function(t){t.target.composing||(e.input=t.target.value)}}}),e.error?n("p",{attrs:{id:"error"}},[e._v(" "+e._s(e.error)+" ")]):e._e(),e.result?n("img",{attrs:{src:e.result}}):e._e()])},i=[],c=n("8aed"),s={name:"Encoder",data:()=>({input:void 0,error:null,result:null,encoder:new c["a"]}),watch:{async input(e){try{const t=await this.encoder.encode(e);this.error=null,this.result=t}catch(t){this.error=t.message,this.result=null}}},mounted(){this.input=""}},o=s,l=(n("2616"),n("2877")),h=Object(l["a"])(o,r,i,!1,null,"1bbef4b0",null),u=h.exports,g=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("h1",{staticClass:"title"},[e._v(" Decode ")]),n("p",{staticClass:"label"},[e._v(" Scanning... "+e._s(e.progress||0)+"% ")]),e.result?n("p",{staticClass:"result"},[e._v(" "+e._s(e.result)+" ")]):e._e(),e.error?n("p",{staticClass:"error"},[e._v(" "+e._s(e.error)+" ")]):e._e(),n("div",{staticClass:"preview"},[n("div",{ref:"viewfinder",staticClass:"viewfinder"}),n("video",{ref:"preview",attrs:{autoplay:"",playsinline:""}})]),n("div",{staticClass:"canvases"},[n("canvas",{ref:"focus",staticClass:"focus"}),n("div",{ref:"debugViews",staticClass:"debugViews"})])])},d=[],p=n("39c7"),w={name:"Decoder",data:()=>({stream:null,isScanning:!1,fps:5,scanInterval:null,result:"",error:"",progress:0,debugViews:{},decoder:new p["a"]}),async mounted(){try{this.stream=await navigator.mediaDevices.getUserMedia({video:{facingMode:{ideal:"environment"}}}),this.decoder._drawDebug=(e,t)=>this.drawDebug(e,t),this.decoder.onResult=e=>this.result=e,this.decoder.onSampleRecorded=({sampleProgress:e})=>this.progress=e,this.startScan()}catch(e){this.stopScan(),this.error=e.message}},beforeDestroy(){this.stopScan()},methods:{startScan(){try{const e=this.$refs.preview;e.srcObject=this.stream,this.scanInterval&&clearInterval(this.scanInterval),this.scanInterval=setInterval(()=>this.detectCode(),1e3/this.fps),this.isScanning=!0}catch(e){this.error=e.message}},stopScan(){this.scanInterval&&clearInterval(this.scanInterval),this.stream.getTracks().forEach(e=>e.stop()),this.isScanning=!1},async detectCode(){const e=this.$refs.preview,t=this.$refs.focus,n=this.computeScanArea({width:e.videoWidth,height:e.videoHeight});this.updateViewfinder(n),t.width=n.width,t.height=n.height,t.getContext("2d").clearRect(0,0,n.width,n.height),t.getContext("2d").drawImage(e,n.x,n.y,n.width,n.height,0,0,t.width,t.height);try{await this.decoder.decode(t.toDataURL().split(",")[1])}catch(a){throw this.error=a.message,a}},computeScanArea({width:e,height:t}){const n=Math.max(e,t)/2,a=e===n?0:(e-n)/2,A=t===n?0:(t-n)/2,r=n/e,i=n/t;return{width:n,height:n,relativeWidth:r,relativeHeight:i,x:a,y:A}},updateViewfinder({relativeWidth:e,relativeHeight:t}){const n=this.$refs.viewfinder,a=this.$refs.preview,A=a.offsetHeight*t,r=a.offsetWidth*e;n.style.width=r+"px",n.style.height=A+"px"},drawDebug(e,t){let n;if(this.debugViews[e])n=this.debugViews[e].canvas;else{const t=document.createElement("div"),a=document.createElement("h4");a.innerText=e,n=document.createElement("canvas"),t.appendChild(a),t.appendChild(n),this.$refs.debugViews.appendChild(t),this.debugViews[e]={container:t,canvas:n}}n.width=160,n.height=160,n.getContext("2d").clearRect(0,0,n.width,n.height);let a=Math.min(n.width/t.width,n.height/t.height),A=(n.width-t.width*a)/2,r=(n.height-t.height*a)/2;var i=new Image;i.onload=function(){n.getContext("2d").drawImage(i,0,0,t.width,t.height,A,r,t.width*a,t.height*a)},i.src=t.data||t.toDataURL()}}},f=w,m=(n("ab17"),Object(l["a"])(f,g,d,!1,null,"892bfcdc",null)),D=m.exports;a["a"].use(A["a"]);const M=[{path:"/",redirect:"/encode"},{path:"/encode",component:u},{path:"/decode",component:D}],C=new A["a"]({routes:M});var v=C,B=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("navigation",{staticStyle:{position:"relative","z-index":"1"}}),n("div",{staticClass:"container"},[n("router-view",{staticClass:"content"})],1)],1)},O=[],b=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"container"},[a("img",{staticClass:"icon",attrs:{src:n("10c9")}}),e._l(e.routes,(function(t){return a("div",{key:t.path,staticClass:"item",class:{active:e.$route.path===t.path}},[a("router-link",{attrs:{to:t.path}},[e._v(" "+e._s(t.title)+" ")])],1)}))],2)},x=[],Q={name:"Navigation",data:()=>({routes:[{path:"/encode",title:"Encode"},{path:"/decode",title:"Decode"}]})},y=Q,G=(n("1ac3"),Object(l["a"])(y,b,x,!1,null,"94b01d48",null)),j=G.exports,E={name:"ShakeyDemo",components:{navigation:j},data:()=>({})},Y=E,N=(n("034f"),Object(l["a"])(Y,B,O,!1,null,null,null)),T=N.exports;a["a"].config.productionTip=!1,new a["a"]({router:v,render(e){return e(T)}}).$mount("#app")},"85ec":function(e,t,n){},"8aed":function(e,t,n){"use strict";(function(e){var a=n("ef21"),A=n.n(a),r=n("0ac7"),i=n.n(r),c=n("c45a");class s{constructor(){}async encode(t){const n=await A.a.read(e.from(i.a.split(",")[1],"base64")),{width:a,height:r}=n.bitmap,s=c["a"].image.getReplaceablePixels(n),o=new c["a"].ColourEncoder,l=o.encode(t,{length:s.length});l.forEach((e,t)=>{const{x:a,y:A}=s[t];n.setPixelColour(e,a,A)});const h=new A.a(1.4*a,1.4*r,A.a.rgbaToInt(255,255,255,0));h.composite(n,Math.floor(a/5),Math.floor(r/5));const u=await h.resize(512,512,A.a.RESIZE_NEAREST_NEIGHBOR).getBase64Async("image/png");return u}}t["a"]=s}).call(this,n("b639").Buffer)},"90dc":function(e,t,n){},ab17:function(e,t,n){"use strict";n("242d")},c45a:function(e,t,n){"use strict";function a(...e){console.log(e.join(" "))}function A(...e){a("[info]",...e)}function r(...e){a("[warn]",...e)}function i(...e){a("[error]",...e)}var c={info:A,warn:r,error:i},s=n("ef21"),o=n.n(s);const l=o.a.rgbaToInt(38,255,0,255);function h(e){const t=[];return e.scan(0,0,e.bitmap.width,e.bitmap.height,(n,a)=>{e.getPixelColour(n,a)===l&&t.push({x:n,y:a})}),t}var u={replaceableColour:l,getReplaceablePixels:h};const g={A:1,B:2,C:3,D:4,E:5,F:6,G:7,H:8,I:9,J:10,K:11,L:12,M:13,N:14,O:15,P:16,Q:17,R:18,S:19,T:20,U:21,V:22,W:23,X:24,Y:25,Z:26,0:27,1:28,2:29,3:30,4:31,5:32,6:33,7:34,8:35,9:36},d={0:o.a.rgbaToInt(255,75,85,255),1:o.a.rgbaToInt(255,255,255,255),2:o.a.rgbaToInt(0,159,255,255)};class p{constructor(e={}){this.characterCodes=e.characterCodes||g,this.bitColours=e.bitColours||d}get charLength(){return Math.max(...Object.values(this.characterCodes).map(e=>e.toString(3).length))}encode(e,t={}){const{length:n}=t,a=e.split(""),A=n-1,r=Math.floor(A/this.charLength);if(a.length>r)throw new Error("Input exceeds max length of "+r);const i=a.map(e=>{const t=this.characterCodes[e];if(!t)throw new Error(`Cannot resolve unknown character: ${e}. Only A-Z and 0-9 are supported.`);return this._padCharacterCode(t.toString(3))}),c=Array(A).fill().map((e,t)=>i.join("").split("")[t]||"0"),s=c.reduce((e,t)=>e+Number(t),0);return c.push(String(s%3)),c.map(e=>this.bitColours[e])}decode(e){const t=e.map(e=>this._findClosestBit(e)),n=t.length-1,a=Array(Math.floor(n/this.charLength)).fill().map((e,n)=>t.slice(n*this.charLength,(n+1)*this.charLength)).filter(e=>!e.every(e=>"0"===e)),A=t.pop(),r=a.map(e=>e.reduce((e,t)=>e+Number(t),0)).reduce((e,t)=>e+Number(t),0);if(Number(A)!==r%3)throw new Error("Failed to decode invalid data");const i=a.map(e=>parseInt(e.join(""),3)),c=i.map(e=>{const[t]=Object.entries(this.characterCodes).find(([,t])=>t===e);if(!t)throw new Error("Failed to resolve character with code "+e);return t}).join("");return c}_padCharacterCode(e){const t=[...Array(this.charLength-e.length).fill("0"),e].join("");return t}findClosestBitColour(e){const[{bit:t,colour:n}]=Object.entries(this.bitColours).map(([t,n])=>{const a=this.calculateColourDistance(e,n);return{bit:t,colour:n,distance:a}}).sort(({distance:e},{distance:t})=>e-t);return{bit:t,colour:n}}calculateColourDistance(e,t){const n=o.a.intToRGBA(e),a=o.a.intToRGBA(t);return Math.pow(a.r-n.r,2)+Math.pow(a.g-n.g,2)+Math.pow(a.b-n.b,2)}_findClosestBit(e){const{bit:t}=this.findClosestBitColour(e);return t}}var w=p;t["a"]={log:c,image:u,ColourEncoder:w}},d174:function(e,t,n){}});
//# sourceMappingURL=app.d3edf841.js.map