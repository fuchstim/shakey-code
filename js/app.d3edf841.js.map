{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/App.vue?9b05","webpack:///./src/lib/decode/_filter.js","webpack:///./src/lib/assets/base.png","webpack:///./public/shakey.png","webpack:///./src/components/navigation/index.vue?0d10","webpack:///./src/components/encoder/index.vue?936e","webpack:///./src/lib/decode/index.js","webpack:///./src/lib/decode/_pattern.js","webpack:///./src/components/encoder/index.vue?eaf2","webpack:///src/components/encoder/index.vue","webpack:///./src/components/encoder/index.vue?2ee4","webpack:///./src/components/encoder/index.vue","webpack:///./src/components/decoder/index.vue?3412","webpack:///src/components/decoder/index.vue","webpack:///./src/components/decoder/index.vue?c882","webpack:///./src/components/decoder/index.vue","webpack:///./src/router/index.js","webpack:///./src/App.vue?e9ad","webpack:///./src/components/navigation/index.vue?5bee","webpack:///src/components/navigation/index.vue","webpack:///./src/components/navigation/index.vue?1857","webpack:///./src/components/navigation/index.vue","webpack:///src/App.vue","webpack:///./src/App.vue?8b47","webpack:///./src/App.vue","webpack:///./src/main.js","webpack:///./src/lib/encode/index.js","webpack:///./src/components/decoder/index.vue?ae0b","webpack:///./src/lib/utils/_log.js","webpack:///./src/lib/utils/_image.js","webpack:///./src/lib/utils/_colour-encoder.js","webpack:///./src/lib/utils/index.js"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","filterPrimaryBitColour","inputImage","colourEncoder","colourCounts","scan","bitmap","width","height","x","y","pixelColour","getPixelColour","colour","bitColour","findClosestBitColour","colourDistance","calculateColourDistance","primaryColour","entries","sort","a","b","pop","Number","filterBitColours","clone","setPixelColour","ShakeyCodeDecoder","drawDebug","onSampleRecorded","onResult","sampleCount","this","_drawDebug","tailPattern","pattern","ColourEncoder","samples","inputData","read","Buffer","from","tail","_findTailPattern","code","_cropCode","bits","_parseCode","_recordSample","decode","error","console","results","findCandidates","tailCodeWidthRatio","tailCodeHeightRatio","codeLocation","Math","ceil","crop","codeSize","pixelHeight","round","pixelWidth","yIndex","xIndex","primaryBitColour","_compareSample","sampleProgress","min","sample1","sample2","every","index","sources","reduce","async","chain","id","source","getBase64Async","Promise","resolve","BLACK","rgbaToInt","WHITE","Pattern","options","lightDarkCutoff","accuracy","patternMatchThreshold","minSegmentLength","outlines","_findOutlines","lineSequences","_getLineSequences","candidates","_findCandidatesWithLineSequences","candidatesWithMatchScore","map","matchScore","_calculateCandidateMatchScore","bestCandidates","filter","input","greyscale","contrast","currentLineSegment","pixelValue","deduplicatedSequences","_deduplicateSequences","_calculateRelativeSegmentLengths","forEach","row","segment","segmentIndex","overlappingCandidate","some","overlapX","overlapY","patternStart","checkSequence","sequencesMatch","_compareSequences","patternWidth","acc","checkSequenceWidth","scale","checkSequenceHeight","sequence","segmentLengths","smallestSegmentLength","baseLengths","baseLength","relativeLength","seq1","seq2","seq1Values","_trimSequence","seq2Values","seq1RelativeSegmentLengths","seq2RelativeSegmentLengths","l1","l2","sequences","matchCounts","matchesPrevious","candidate","candidateArea","candidateLineSequences","patternLineSequences","rowCount","lineMatchResults","Array","fill","_","candidateLineSequence","patternLineSequence","match","lineMatchScore","render","_vm","_h","$createElement","_c","_self","staticClass","_v","directives","rawName","expression","attrs","domProps","on","$event","target","composing","_s","_e","staticRenderFns","undefined","encoder","watch","encode","message","component","progress","ref","stream","isScanning","fps","scanInterval","debugViews","decoder","navigator","mediaDevices","getUserMedia","video","facingMode","ideal","content","startScan","stopScan","methods","$refs","preview","srcObject","clearInterval","setInterval","detectCode","e","getTracks","track","stop","focus","scanArea","computeScanArea","videoWidth","videoHeight","updateViewfinder","getContext","clearRect","drawImage","toDataURL","split","scanAreaWidth","max","topCornerX","topCornerY","relativeWidth","relativeHeight","viewfinder","offsetHeight","offsetWidth","style","canvas","container","document","createElement","title","innerText","appendChild","ratio","image","Image","onload","src","use","routes","path","redirect","router","staticStyle","_l","route","class","active","$route","components","navigation","config","productionTip","h","App","$mount","ShakeyCodeEncoder","baseImage","replaceablePixels","getReplaceablePixels","encodedCode","outputImage","composite","floor","resize","RESIZE_NEAREST_NEIGHBOR","log","fragments","join","info","warn","REPLACEABLE_COLOUR","replaceableColour","CHARACTER_CODES","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","0","1","2","3","4","5","6","7","8","9","BIT_COLOURS","characterCodes","bitColours","values","v","toString","characters","maxBitCount","maxCharacterCount","charLength","Error","characterCode","_padCharacterCode","parityBit","String","colours","_findClosestBit","characterBitsCount","characterBits","parityBitCheck","parseInt","decoded","character","find","bit","distance","c1","c2","intToRGBA","pow","g"],"mappings":"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","file":"js/app.d3edf841.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t\"app\": 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/shakey-code/\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([0,\"chunk-vendors\"]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","export * from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=style&index=0&lang=css&\"","function filterPrimaryBitColour(inputImage, colourEncoder) {\n  const colourCounts = {};\n\n  inputImage.scan(0, 0, inputImage.bitmap.width, inputImage.bitmap.height, (x, y) => {\n    const pixelColour = inputImage.getPixelColour(x, y);\n    const { colour: bitColour } = colourEncoder.findClosestBitColour(pixelColour);\n\n    const colourDistance = colourEncoder.calculateColourDistance(pixelColour, bitColour);\n\n    if (colourDistance < 20000) {\n      colourCounts[bitColour] = (colourCounts[bitColour] || 0) + 1;\n    }\n  });\n\n  const primaryColour = Object.entries(colourCounts)\n    .sort(([ , a ], [ , b ]) => a - b)\n    .pop();\n\n  return primaryColour && Number(primaryColour[0]);\n}\n\nfunction filterBitColours(inputImage, colourEncoder) {\n  const result = inputImage.clone();\n\n  result.scan(0, 0, result.bitmap.width, result.bitmap.height, (x, y) => {\n    const pixelColour = result.getPixelColour(x, y);\n    const { colour: bitColour } = colourEncoder.findClosestBitColour(pixelColour);\n\n    const colourDistance = colourEncoder.calculateColourDistance(pixelColour, bitColour);\n\n    if (colourDistance > 20000) {\n      result.setPixelColour(0, x, y);\n    } else {\n      result.setPixelColour(bitColour, x, y);\n    }\n  });\n\n  return result;\n}\n\nexport default {\n  filterPrimaryBitColour,\n  filterBitColours,\n};\n","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABoAAAAaCAYAAACpSkzOAAAAAXNSR0IArs4c6QAAAfxJREFUSEutlr1OwzAQx89EIF4ChiKEusHUiGfo2DIi3oGBATFFDAy8A3NbmMoroHYCFmiF6FB4iUokRuf4krPzYafqLW0S+3735X8ioIm1OhIWU+HcUrLOvYm84uabCUAUQgbDe2QUQNk6AGgEkt8TEA+QwtAQTMbuyQsAccACWgeEfhWsxjYC4hB0aIPj8wSCw9O8vDogv9JR3fUmAvCkMIAMbJVNBeOcIFzAQBxycnWvtr/eXapy4jO89zYamm4XU9EIRBACyCSB96fHfDCiEI57/RRkDYo3CCcOjSAUchLHsBUEKit6tj5Ilw9hHITOyXCcKRg12nz8o7BBj1jVsTyqL+QQoBqC+7xArY6U7X2jucH8F+Kvl8IcqazYWtEbZEqS9qhMSuxpG50ZjsXH0rjeEQJW7T11b3u2hD8SJy1Ngo9uJi3kgk+OLoGdHaftzn7U5UrKigPLMyLnqF38v/aIoKOxdU4AYN7tg/hcmgDya5wj6/Sr7EpE0xtkqXh+jvDB9QTgVo8mH09dNvzZDMjuDUk/a4QTVOajIEEe5asDZfGMB/mrRL8oixLEB6NwUtLSOc0LRF5sxe6a54jD1LTVWa16O0CGc48Plmr15v2KTGnB4MXz0E/5daZuEH312L3zyMIob2VpKz6bnINQsaA+I9zUMPKqQP4B3LkjinGnCIMAAAAASUVORK5CYIIA\"","module.exports = \"data:image/png;base64,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\"","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&id=94b01d48&scoped=true&lang=css&\"","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&id=1bbef4b0&scoped=true&lang=css&\"","import Jimp from 'jimp';\n\nimport filter from './_filter';\nimport Pattern from './_pattern';\nimport utils from '../utils';\n\nclass ShakeyCodeDecoder {\n  constructor({ drawDebug, onSampleRecorded, onResult, sampleCount } = {}) {\n    this._drawDebug = drawDebug;\n    this.onSampleRecorded = onSampleRecorded || (() => {});\n    this.onResult = onResult || (() => {});\n    this.sampleCount = sampleCount || 3;\n\n    this.tailPattern = new Pattern({\n      drawDebug: s => this.drawDebug(s),\n      pattern: [\n        [{ length: 3, value: 1 }, { length: 2, value: 0 }, { length: 1, value: 1 }, { length: 2, value: 0 }, { length: 3, value: 1 }],\n        [{ length: 1, value: 0 }, { length: 1, value: 1 }, { length: 3, value: 0 }, { length: 1, value: 1 }, { length: 3, value: 0 }, { length: 2, value: 1 }],\n        [{ length: 1, value: 0 }, { length: 1, value: 1 }, { length: 1, value: 0 }, { length: 3, value: 1 }, { length: 3, value: 0 }, { length: 2, value: 1 }],\n        [{ length: 1, value: 0 }, { length: 3, value: 1 }, { length: 2, value: 0 }, { length: 5, value: 1 }],\n        [{ length: 2, value: 0 }, { length: 1, value: 1 }, { length: 3, value: 0 }, { length: 1, value: 1 }, { length: 3, value: 0 }, { length: 1, value: 1 }],\n      ],\n    });\n\n    this.colourEncoder = new utils.ColourEncoder();\n\n    this.samples = [];\n  }\n\n  async decode(inputData) {\n    if (!inputData.length) {\n      return;\n    }\n\n    // eslint-disable-next-line no-undef\n    const inputImage = (await Jimp.read(Buffer.from(inputData, 'base64')));\n\n    const tail = this._findTailPattern(inputImage);\n\n    if (!tail) { return; }\n\n    const code = this._cropCode(inputImage, tail);\n\n    const bits = this._parseCode(code);\n\n    this._recordSample(bits);\n\n    if (this.samples.length >= this.sampleCount) {\n      try {\n        const result = this.colourEncoder.decode(this.samples[0]);\n\n        this.onResult.apply(this.onResult, [ result ]);\n      } catch (error) {\n        this.samples = [];\n\n        console.error(error);\n      }\n    }\n  }\n\n  _findTailPattern(inputImage) {\n    const results = this.tailPattern.findCandidates(inputImage);\n\n    return results[0];\n  }\n\n  _cropCode(inputImage, tail) {\n    const tailCodeWidthRatio = 7 / 11;\n    const tailCodeHeightRatio = 7 / 5;\n\n    const codeLocation = {\n      x: tail.x + tail.width,\n      y: tail.y - (((tail.height * tailCodeHeightRatio) - tail.height) / 2),\n      width: Math.ceil(tail.width * tailCodeWidthRatio),\n      height: Math.ceil(tail.height * tailCodeHeightRatio),\n    };\n\n    const code = inputImage\n      .clone()\n      .crop(codeLocation.x, codeLocation.y, codeLocation.width, codeLocation.height);\n\n    return code;\n  }\n\n  _parseCode(code) {\n    const codeSize = 7;\n    const pixelHeight = Math.round(code.bitmap.height / codeSize);\n    const pixelWidth = Math.round(code.bitmap.width / codeSize);\n\n    const bits = [];\n    for (let yIndex = 1; yIndex < codeSize - 1; yIndex++) {\n      const y = yIndex * pixelWidth;\n\n      for (let xIndex = 1; xIndex < codeSize - 1; xIndex++) {\n        const x = xIndex * pixelWidth;\n\n        const primaryBitColour = filter.filterPrimaryBitColour(\n          code.clone().crop(x, y, pixelWidth, pixelHeight),\n          this.colourEncoder\n        );\n\n        bits.push(primaryBitColour);\n      }\n    }\n\n    return bits;\n  }\n\n  _recordSample(bits) {\n    if (!this._compareSample(this.samples[0], bits)) {\n      this.samples = [ bits ];\n    } else {\n      this.samples.push(bits);\n    }\n\n    this.onSampleRecorded.apply(this.onSampleRecorded, [{\n      bits,\n      samples: this.samples,\n      sampleProgress: Math.min(Math.round((this.samples.length * 100) / this.sampleCount), 100),\n    }]);\n  }\n\n  _compareSample(sample1, sample2) {\n    if (!sample1 || !sample2) {\n      return false;\n    }\n\n    return sample1.every((s, index) => s === sample2[index]);\n  }\n\n  async drawDebug(sources) {\n    await Object.entries(sources)\n      .reduce(async (chain, [ id, source ]) => {\n        await chain;\n\n        this._drawDebug(id, {\n          width: source.bitmap.width,\n          height: source.bitmap.height,\n          data: await source.getBase64Async('image/png'),\n        });\n      }, Promise.resolve());\n  }\n}\n\nexport default ShakeyCodeDecoder;\n","import Jimp from 'jimp';\n\nconst BLACK = Jimp.rgbaToInt(0, 0, 0, 255);\nconst WHITE = Jimp.rgbaToInt(255, 255, 255, 255);\nclass Pattern {\n  constructor(options) {\n    this.pattern = options.pattern;\n    this.lightDarkCutoff = options.lightDarkCutoff || Jimp.rgbaToInt(10, 10, 10, 255);\n    this.drawDebug = options.drawDebug;\n    this.accuracy = options.accuracy || 0.5;\n    this.patternMatchThreshold = options.patternMatchThreshold || this.accuracy;\n    this.minSegmentLength = options.minSegmentLength || 5;\n  }\n\n  findCandidates(inputImage) {\n    const outlines = this._findOutlines(inputImage);\n\n    const lineSequences = this._getLineSequences(outlines);\n\n    const candidates = this._findCandidatesWithLineSequences(lineSequences);\n\n    const candidatesWithMatchScore = candidates.map(c => ({\n      ...c,\n      matchScore: this._calculateCandidateMatchScore(outlines, c),\n    }));\n\n    const bestCandidates = candidatesWithMatchScore\n      .filter(({ matchScore }) => matchScore >= this.patternMatchThreshold)\n      .sort((a, b) => b.matchScore - a.matchScore);\n\n    return bestCandidates;\n  }\n\n  _findOutlines(input) {\n    const outlines = input.clone();\n    outlines\n      .greyscale()\n      .contrast(0.1)\n      .scan(0, 0, outlines.bitmap.width, outlines.bitmap.height, (x, y) => {\n        if (outlines.getPixelColour(x, y) >= this.lightDarkCutoff) {\n          outlines.setPixelColour(WHITE, x, y);\n        } else {\n          outlines.setPixelColour(BLACK, x, y);\n        }\n      });\n\n    return outlines;\n  }\n\n  _getLineSequences(outlines) {\n    const lineSequences = [];\n\n    for (let y = 1; y <= outlines.bitmap.height; y++) {\n      lineSequences[y] = [];\n\n      let currentLineSegment = {\n        x: 0,\n        y,\n        value: outlines.getPixelColour(1, y) === BLACK ? 1 : 0,\n        length: 0,\n      };\n\n      for (let x = 1; x <= outlines.bitmap.width; x++) {\n        const pixelValue = outlines.getPixelColour(x, y) === BLACK ? 1 : 0;\n\n        if (currentLineSegment.value === pixelValue) {\n          currentLineSegment.length++;\n        } else {\n          if (currentLineSegment.length >= this.minSegmentLength) {\n            lineSequences[y].push(currentLineSegment);\n          }\n\n          currentLineSegment = { x, y, value: pixelValue, length: 1 };\n        }\n      }\n\n      if (currentLineSegment.length >= this.minSegmentLength) {\n        lineSequences[y].push(currentLineSegment);\n      }\n    }\n\n    const deduplicatedSequences = this._deduplicateSequences(lineSequences);\n\n    return deduplicatedSequences.map(s => this._calculateRelativeSegmentLengths(s));\n  }\n\n  _findCandidatesWithLineSequences(lineSequences) {\n    const candidates = [];\n\n    lineSequences.forEach(row => {\n      row.forEach((segment, segmentIndex) => {\n        const overlappingCandidate = candidates.some(({ x, y, width, height }) => {\n          const overlapX = segment.x >= x && segment.x <= (x + width);\n          const overlapY = segment.y >= y && segment.y <= (y + height);\n\n          return overlapX && overlapY;\n        });\n        if (overlappingCandidate) {\n          return;\n        }\n\n        const patternStart = this.pattern[0];\n        const checkSequence = row.slice(segmentIndex, segmentIndex + patternStart.length);\n\n        const sequencesMatch = this._compareSequences(patternStart, checkSequence);\n        if (!sequencesMatch) {\n          return;\n        }\n\n        // Approximate pattern size\n\n        const patternWidth = patternStart.reduce((acc, { length }) => acc + length, 0);\n        const checkSequenceWidth = checkSequence.reduce((acc, { length }) => acc + length, 0);\n\n        const scale = Math.round(checkSequenceWidth / patternWidth);\n\n        const checkSequenceHeight = this.pattern.length * scale;\n\n        candidates.push({\n          x: segment.x,\n          y: segment.y,\n          scale,\n          width: checkSequenceWidth,\n          height: checkSequenceHeight,\n        });\n      });\n    });\n\n    return candidates;\n  }\n\n  _calculateRelativeSegmentLengths(sequence) {\n    const segmentLengths = sequence\n      .map(({ length }) => Number(length))\n      .sort((a, b) => a - b);\n\n    const smallestSegmentLength = segmentLengths[0];\n    const baseLengths = segmentLengths.filter(\n      x => x >= smallestSegmentLength * this.accuracy && x <= smallestSegmentLength * (2 - this.accuracy)\n    );\n    const baseLength = baseLengths.reduce((acc, x) => acc + x, 0) / baseLengths.length;\n\n    const result = sequence.map(segment => ({\n      ...segment,\n      relativeLength: segment.length / baseLength,\n    }));\n\n    return result;\n  }\n\n  _trimSequence(sequence) {\n    return sequence.slice(\n      sequence[0].value === 0 ? 1 : 0,\n      sequence[sequence.length - 1].value === 0 ? (sequence.length - 1) : sequence.length\n    );\n  }\n\n  _compareSequences(seq1, seq2) {\n    const seq1Values = this._trimSequence(seq1).map(({ value }) => value);\n\n    const seq2Values = this._trimSequence(seq2).map(({ value }) => value);\n\n    // Check sequences have same number of segments\n    if (seq1Values.length !== seq2Values.length) {\n      return false;\n    }\n\n    // Check segments have same values\n    for (let i = 0; i < seq1Values.length; i++) {\n      if (seq1Values[i] !== seq2Values[i]) {\n        return false;\n      }\n    }\n\n    // Check relative segment lengths are (very) similar\n    const seq1RelativeSegmentLengths = this._calculateRelativeSegmentLengths(seq1).map(({ relativeLength }) => relativeLength);\n    const seq2RelativeSegmentLengths = this._calculateRelativeSegmentLengths(seq2).map(({ relativeLength }) => relativeLength);\n\n    for (let i = 0; i < seq1RelativeSegmentLengths.length; i++) {\n      const l1 = seq1RelativeSegmentLengths[i];\n      const l2 = seq2RelativeSegmentLengths[i];\n\n      if (l1 < l2 * this.accuracy || l1 > l2 * (2 - this.accuracy)) {\n        return false;\n      }\n    }\n\n    return true;\n  }\n\n  _deduplicateSequences(sequences) {\n    const matchCounts = [];\n    const deduplicatedSequences = sequences.reduce((acc, sequence) => {\n      if (!acc.length) {\n        matchCounts.push(0);\n        return [ sequence ];\n      }\n\n      const matchesPrevious = this._compareSequences(sequence, acc[acc.length - 1]);\n      if (matchesPrevious) {\n        matchCounts[matchCounts.length - 1] += 1;\n      } else {\n        // If this row has appeared less than 1 time, discard it\n\n        if (matchCounts[matchCounts.length - 1] < 1) {\n          acc.pop();\n          matchCounts.pop();\n        }\n\n        matchCounts.push(0);\n        acc.push(sequence);\n      }\n\n      return acc;\n    }, []);\n\n    return deduplicatedSequences;\n  }\n\n  _calculateCandidateMatchScore(outlines, candidate) {\n    const candidateArea = outlines.clone().crop(candidate.x, candidate.y, candidate.width, candidate.height);\n\n    const candidateLineSequences = this._getLineSequences(candidateArea);\n\n    const patternLineSequences = this.pattern;\n\n    const rowCount = Math.min(candidateLineSequences.length, patternLineSequences.length);\n\n    const lineMatchResults = Array(rowCount).fill()\n      .map((_, index) => {\n        const candidateLineSequence = candidateLineSequences[index];\n        const patternLineSequence = patternLineSequences[index];\n        const match = this._compareSequences(candidateLineSequence, patternLineSequence);\n\n        return { candidateLineSequence, patternLineSequence, match };\n      });\n\n    const lineMatchScore = Math.round(\n      (lineMatchResults.filter(({ match }) => match).length * 100) / lineMatchResults.length\n    ) / 100;\n\n    return lineMatchScore;\n  }\n}\n\nexport default Pattern;\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('h1',{staticClass:\"title\"},[_vm._v(\" Encode \")]),_c('p',{staticClass:\"label\"},[_vm._v(\" Input code here: \")]),_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.input),expression:\"input\"}],staticClass:\"code\",attrs:{\"type\":\"text\",\"autofocus\":\"\"},domProps:{\"value\":(_vm.input)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.input=$event.target.value}}}),(_vm.error)?_c('p',{attrs:{\"id\":\"error\"}},[_vm._v(\" \"+_vm._s(_vm.error)+\" \")]):_vm._e(),(_vm.result)?_c('img',{attrs:{\"src\":_vm.result}}):_vm._e()])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<style scoped>\n  h1.title {\n    margin-top: 0;\n  }\n\n  p.label {\n    margin-bottom: 2px;\n  }\n\n  input.code {\n    width: calc(100% - 36px);\n    border-radius: 10px;\n    border: 1px solid #f1f1f1;\n    background-color: #f1f1f1;\n    padding: 8px 16px;\n    transition: all .2s ease-in-out;\n  }\n\n  input.code:focus {\n    border: 1px solid #009fff;\n    outline: none;\n    box-shadow: #ebebeb 0 0 10px;\n    transform: scale(1.005);\n  }\n\n  p#error {\n    background-color: red;\n    color: white;\n    padding: 12px;\n    border-radius: 10px;\n  }\n\n  img {\n    width: 100%;\n    height: auto;\n  }\n</style>\n\n<template>\n  <div>\n    <h1 class=\"title\">\n      Encode\n    </h1>\n\n    <p class=\"label\">\n      Input code here:\n    </p>\n    <input\n      v-model=\"input\"\n      class=\"code\"\n      type=\"text\"\n      autofocus\n    >\n\n    <p\n      v-if=\"error\"\n      id=\"error\"\n    >\n      {{ error }}\n    </p>\n\n    <img\n      v-if=\"result\"\n      :src=\"result\"\n    >\n  </div>\n</template>\n\n<script>\n\nimport ShakeyCodeEncoder from '../../lib/encode';\n\nexport default {\n  name: 'Encoder',\n\n  data: () => ({\n    input: undefined,\n    error: null,\n    result: null,\n    encoder: new ShakeyCodeEncoder(),\n  }),\n\n  watch: {\n    async input(code) {\n      try {\n        const result = await this.encoder.encode(code);\n        this.error = null;\n        this.result = result;\n      } catch (error) {\n        this.error = error.message;\n        this.result = null;\n      }\n    },\n  },\n\n  mounted() { this.input = ''; },\n};\n</script>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=1bbef4b0&scoped=true&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&id=1bbef4b0&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"1bbef4b0\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('h1',{staticClass:\"title\"},[_vm._v(\" Decode \")]),_c('p',{staticClass:\"label\"},[_vm._v(\" Scanning... \"+_vm._s(_vm.progress || 0)+\"% \")]),(_vm.result)?_c('p',{staticClass:\"result\"},[_vm._v(\" \"+_vm._s(_vm.result)+\" \")]):_vm._e(),(_vm.error)?_c('p',{staticClass:\"error\"},[_vm._v(\" \"+_vm._s(_vm.error)+\" \")]):_vm._e(),_c('div',{staticClass:\"preview\"},[_c('div',{ref:\"viewfinder\",staticClass:\"viewfinder\"}),_c('video',{ref:\"preview\",attrs:{\"autoplay\":\"\",\"playsinline\":\"\"}})]),_c('div',{staticClass:\"canvases\"},[_c('canvas',{ref:\"focus\",staticClass:\"focus\"}),_c('div',{ref:\"debugViews\",staticClass:\"debugViews\"})])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<style scoped>\n  h1.title {\n    margin-top: 0;\n  }\n\n  p.label {\n    margin-bottom: 2px;\n  }\n\n  input {\n    width: 100%\n  }\n\n  p.result {\n    background-color: green;\n    color: white;\n    padding: 12px;\n    border-radius: 10px;\n  }\n\n  p.error {\n    background-color: red;\n    color: white;\n    padding: 12px;\n    border-radius: 10px;\n  }\n\n  div.preview {\n    width: 100%;\n    position: relative;\n    height: max-content;\n  }\n\n  div.preview video {\n    width: 100%;\n    border-radius: 10px;\n    box-shadow: #ebebeb 0 0 10px;\n  }\n\n  div.preview div.viewfinder {\n    position: absolute;\n    box-shadow: inset 0px 0px 0px 5px #009fff;\n    border-radius: 5px;\n    top: 50%;\n    left: 50%;\n    transform: translate(-50%, -50%)\n  }\n\n  div.canvases {\n    display: flex;\n    flex-direction: row;\n  }\n\n  div.canvases canvas.focus {\n    display: none;\n  }\n\n  div.canvases div.debugViews {\n    display: grid;\n    grid-gap: 12px;\n    grid-template-columns: auto auto auto auto auto;\n  }\n\n  div.canvases div.debugViews canvas {\n    width: 160px;\n    height: 160px;\n  }\n</style>\n\n<template>\n  <div>\n    <h1 class=\"title\">\n      Decode\n    </h1>\n\n    <p class=\"label\">\n      Scanning... {{ progress || 0 }}%\n    </p>\n    <p\n      v-if=\"result\"\n      class=\"result\"\n    >\n      {{ result }}\n    </p>\n    <p\n      v-if=\"error\"\n      class=\"error\"\n    >\n      {{ error }}\n    </p>\n\n    <div class=\"preview\">\n      <div\n        ref=\"viewfinder\"\n        class=\"viewfinder\"\n      />\n      <video\n        ref=\"preview\"\n        autoplay\n        playsinline\n      />\n    </div>\n\n    <div class=\"canvases\">\n      <canvas\n        ref=\"focus\"\n        class=\"focus\"\n      />\n\n      <div\n        ref=\"debugViews\"\n        class=\"debugViews\"\n      />\n    </div>\n  </div>\n</template>\n\n<script>\n\nimport ShakeyCodeDecoder from '../../lib/decode';\n\nexport default {\n  name: 'Decoder',\n\n  data: () => ({\n    stream: null,\n    isScanning: false,\n    fps: 5,\n    scanInterval: null,\n    result: '',\n    error: '',\n    progress: 0,\n\n    debugViews: {},\n    decoder: new ShakeyCodeDecoder(),\n  }),\n\n  async mounted() {\n    try {\n      this.stream = await navigator.mediaDevices.getUserMedia({\n        video: {\n          facingMode: { ideal: 'environment' },\n        },\n      });\n\n      this.decoder._drawDebug = (id, content) => this.drawDebug(id, content);\n      this.decoder.onResult = result => this.result = result;\n      this.decoder.onSampleRecorded = ({ sampleProgress }) => this.progress = sampleProgress;\n\n      this.startScan();\n    } catch (error) {\n      this.stopScan();\n\n      this.error = error.message;\n    }\n  },\n\n  beforeDestroy() {\n    this.stopScan();\n  },\n\n  methods: {\n    startScan() {\n      try {\n        const video = this.$refs.preview;\n        video.srcObject = this.stream;\n\n        this.scanInterval && clearInterval(this.scanInterval);\n        this.scanInterval = setInterval(\n          () => this.detectCode(),\n          (1000 / this.fps)\n        );\n\n        this.isScanning = true;\n      } catch (e) {\n        this.error = e.message;\n      }\n    },\n\n    stopScan() {\n      this.scanInterval && clearInterval(this.scanInterval);\n\n      this.stream.getTracks().forEach(track => track.stop());\n\n      this.isScanning = false;\n    },\n\n    async detectCode() {\n      const video = this.$refs.preview;\n      const focus = this.$refs.focus;\n\n      const scanArea = this.computeScanArea({ width: video.videoWidth, height: video.videoHeight });\n\n      this.updateViewfinder(scanArea);\n\n      focus.width = scanArea.width;\n      focus.height = scanArea.height;\n\n      focus.getContext('2d').clearRect(0, 0, scanArea.width, scanArea.height);\n      focus.getContext('2d').drawImage(\n        /* image = */ video,\n        /* sx = */ scanArea.x,\n        /* sy = */ scanArea.y,\n        /* sWidth = */ scanArea.width,\n        /* sHeight = */ scanArea.height,\n        /* dx = */ 0,\n        /* dy = */ 0,\n        /* dWidth = */ focus.width,\n        /* dHeight = */ focus.height\n      );\n\n      try {\n        await this.decoder.decode(focus.toDataURL().split(',')[1]);\n      } catch (e) {\n        this.error = e.message;\n        throw e;\n      }\n    },\n\n    computeScanArea({ width, height }) {\n      const scanAreaWidth = Math.max(width, height) / 2;\n      const topCornerX = width === scanAreaWidth ? 0 : ((width - scanAreaWidth) / 2);\n      const topCornerY = height === scanAreaWidth ? 0 : ((height - scanAreaWidth) / 2);\n\n      const relativeWidth = scanAreaWidth / width;\n      const relativeHeight = scanAreaWidth / height;\n\n      return {\n        width: scanAreaWidth,\n        height: scanAreaWidth,\n        relativeWidth,\n        relativeHeight,\n        x: topCornerX,\n        y: topCornerY,\n      };\n    },\n\n    updateViewfinder({ relativeWidth, relativeHeight }) {\n      const viewfinder = this.$refs.viewfinder;\n      const video = this.$refs.preview;\n\n      const height = video.offsetHeight * relativeHeight;\n      const width = video.offsetWidth * relativeWidth;\n\n      viewfinder.style.width = `${width}px`;\n      viewfinder.style.height = `${height}px`;\n    },\n\n    drawDebug(id, content) {\n      let canvas;\n      if (this.debugViews[id]) {\n        canvas = this.debugViews[id].canvas;\n      } else {\n        const container = document.createElement('div');\n        const title = document.createElement('h4');\n        title.innerText = id;\n\n        canvas = document.createElement('canvas');\n        container.appendChild(title);\n        container.appendChild(canvas);\n\n        this.$refs.debugViews.appendChild(container);\n\n        this.debugViews[id] = { container, canvas };\n      }\n\n      canvas.width = 160;\n      canvas.height = 160;\n\n      canvas.getContext('2d').clearRect(0, 0, canvas.width, canvas.height);\n\n      let ratio = Math.min(canvas.width / content.width, canvas.height / content.height);\n      let x = (canvas.width - content.width * ratio) / 2;\n      let y = (canvas.height - content.height * ratio) / 2;\n\n      var image = new Image();\n\n      image.onload = function () {\n        canvas.getContext('2d').drawImage(\n          image,\n          0,\n          0,\n          content.width,\n          content.height,\n          x,\n          y,\n          content.width * ratio,\n          content.height * ratio\n        );\n      };\n\n      image.src = content.data || content.toDataURL();\n    },\n  },\n};\n</script>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=892bfcdc&scoped=true&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&id=892bfcdc&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"892bfcdc\",\n  null\n  \n)\n\nexport default component.exports","import Vue from 'vue';\nimport VueRouter from 'vue-router';\n\nimport Encoder from '../components/encoder';\nimport Decoder from '../components/decoder';\n\nVue.use(VueRouter);\n\nconst routes = [\n  { path: '/', redirect: '/encode' },\n  { path: '/encode', component: Encoder },\n  { path: '/decode', component: Decoder },\n];\n\nconst router = new VueRouter({\n  routes,\n});\n\nexport default router;\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"app\"}},[_c('navigation',{staticStyle:{\"position\":\"relative\",\"z-index\":\"1\"}}),_c('div',{staticClass:\"container\"},[_c('router-view',{staticClass:\"content\"})],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"container\"},[_c('img',{staticClass:\"icon\",attrs:{\"src\":require(\"../../../public/shakey.png\")}}),_vm._l((_vm.routes),function(route){return _c('div',{key:route.path,staticClass:\"item\",class:{ active: _vm.$route.path === route.path }},[_c('router-link',{attrs:{\"to\":route.path}},[_vm._v(\" \"+_vm._s(route.title)+\" \")])],1)})],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<style scoped>\n  div.container {\n    display: flex;\n    flex-direction: row;\n    justify-content: left;\n    width: 100%;\n    background-color: #009fff;\n    height: 48px;\n    box-shadow: #ebebeb 0 0 10px;\n  }\n\n  div.container img.icon {\n    height: 100%;\n    width: auto;\n    margin: 0 24px;\n  }\n\n  div.container div.item {\n    height: 100%;\n    display: flex;\n    align-items: center;\n    font-size: 18px;\n    padding: 0 12px;\n    text-decoration: none;\n    color: white;\n    transition: all .2s ease-in-out;\n  }\n\n  div.container div.item:hover, div.container div.item.active {\n    background-color: white;\n    color: #009fff;\n  }\n\n  div.container div.item a {\n    font-size: 18px;\n    text-decoration: none;\n    color: inherit;\n    font-weight: bold;\n  }\n</style>\n\n<template>\n  <div class=\"container\">\n    <img\n      class=\"icon\"\n      src=\"../../../public/shakey.png\"\n    >\n    <div\n      v-for=\"route in routes\"\n      :key=\"route.path\"\n      class=\"item\"\n      :class=\"{ active: $route.path === route.path }\"\n    >\n      <router-link :to=\"route.path\">\n        {{ route.title }}\n      </router-link>\n    </div>\n  </div>\n</template>\n\n<script>\nexport default {\n  name: 'Navigation',\n\n  data: () => ({\n    routes: [\n      { path: '/encode', title: 'Encode' },\n      { path: '/decode', title: 'Decode' },\n    ],\n  }),\n};\n</script>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=94b01d48&scoped=true&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&id=94b01d48&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"94b01d48\",\n  null\n  \n)\n\nexport default component.exports","<style>\n  html, body {\n    margin: 0;\n    padding: 0;\n  }\n\n  #app {\n    font-family: Avenir, Helvetica, Arial, sans-serif;\n    -webkit-font-smoothing: antialiased;\n    -moz-osx-font-smoothing: grayscale;\n    color: #2c3e50;\n  }\n\n  div.container {\n    width: 100%;\n    display: flex;\n    justify-content: center;\n  }\n\n  div.container div.content {\n    z-index: 0;\n    width: 80%;\n    max-width: 500px;\n    height: 100%;\n    padding: 32px 48px 48px 48px;\n    border-radius: 0 0 10px 10px;\n    box-shadow: #ebebeb 0 0 20px;\n  }\n\n  @media only screen and (max-width: 600px) {\n    div.container div.content {\n      width: 100%;\n      max-width: 100%;\n      border-radius: 0;\n      box-shadow: none;\n    }\n  }\n</style>\n\n<template>\n  <div id=\"app\">\n    <navigation style=\"position: relative; z-index: 1\" />\n\n    <div class=\"container\">\n      <router-view class=\"content\" />\n    </div>\n  </div>\n</template>\n\n<script>\n\nimport navigation from './components/navigation';\n\nexport default {\n  name: 'ShakeyDemo',\n\n  components: {\n    navigation,\n  },\n\n  data: () => ({ }),\n};\n</script>\n","import mod from \"-!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./App.vue?vue&type=template&id=e500e73a&\"\nimport script from \"./App.vue?vue&type=script&lang=js&\"\nexport * from \"./App.vue?vue&type=script&lang=js&\"\nimport style0 from \"./App.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","import Vue from 'vue';\n\nimport router from './router';\nimport App from './App.vue';\n\nVue.config.productionTip = false;\n\nnew Vue({\n  router,\n  render(h) { return h(App); },\n}).$mount('#app');\n","import Jimp from 'jimp';\n\nimport baseImageSource from '../assets/base.png';\nimport utils from '../utils';\n\nclass ShakeyCodeEncoder {\n  constructor() { }\n\n  async encode(code) {\n    // eslint-disable-next-line no-undef\n    const baseImage = await Jimp.read(Buffer.from(baseImageSource.split(',')[1], 'base64'));\n\n    const { width, height } = baseImage.bitmap;\n\n    const replaceablePixels = utils.image.getReplaceablePixels(baseImage);\n\n    const colourEncoder = new utils.ColourEncoder();\n    const encodedCode = colourEncoder.encode(code, { length: replaceablePixels.length });\n\n    encodedCode.forEach((colour, index) => {\n      const { x, y } = replaceablePixels[index];\n\n      baseImage.setPixelColour(colour, x, y);\n    });\n\n    const outputImage = new Jimp(width * 1.4, height * 1.4, Jimp.rgbaToInt(255, 255, 255, 0));\n\n    outputImage.composite(baseImage, Math.floor(width / 5), Math.floor(height / 5));\n\n    const result = await outputImage.resize(512, 512, Jimp.RESIZE_NEAREST_NEIGHBOR).getBase64Async('image/png');\n\n    return result;\n  }\n}\n\nexport default ShakeyCodeEncoder;\n","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&id=892bfcdc&scoped=true&lang=css&\"","function log(...fragments) { console.log(fragments.join(' ')); }\n\nfunction info(...fragments) { log('[info]', ...fragments); }\nfunction warn(...fragments) { log('[warn]', ...fragments); }\nfunction error(...fragments) { log('[error]', ...fragments); }\n\nexport default {\n  info,\n  warn,\n  error,\n};\n\n","import Jimp from 'jimp';\n\nconst REPLACEABLE_COLOUR = Jimp.rgbaToInt(38, 255, 0, 255);\nfunction getReplaceablePixels(inputImage) {\n  const replaceablePixels = [];\n  inputImage.scan(0, 0, inputImage.bitmap.width, inputImage.bitmap.height, (x, y) => {\n    if (inputImage.getPixelColour(x, y) === REPLACEABLE_COLOUR) {\n      replaceablePixels.push({ x, y });\n    }\n  });\n\n  return replaceablePixels;\n}\n\nexport default {\n  replaceableColour: REPLACEABLE_COLOUR,\n  getReplaceablePixels,\n};\n","import Jimp from 'jimp';\n\nconst CHARACTER_CODES = {\n  A: 1,\n  B: 2,\n  C: 3,\n  D: 4,\n  E: 5,\n  F: 6,\n  G: 7,\n  H: 8,\n  I: 9,\n  J: 10,\n  K: 11,\n  L: 12,\n  M: 13,\n  N: 14,\n  O: 15,\n  P: 16,\n  Q: 17,\n  R: 18,\n  S: 19,\n  T: 20,\n  U: 21,\n  V: 22,\n  W: 23,\n  X: 24,\n  Y: 25,\n  Z: 26,\n  0: 27,\n  1: 28,\n  2: 29,\n  3: 30,\n  4: 31,\n  5: 32,\n  6: 33,\n  7: 34,\n  8: 35,\n  9: 36,\n};\n\nconst BIT_COLOURS = {\n  0: Jimp.rgbaToInt(255, 75, 85, 255), // #ff4b55\n  1: Jimp.rgbaToInt(255, 255, 255, 255), // #ffffff\n  2: Jimp.rgbaToInt(0, 159, 255, 255), // #009fff\n};\n\nclass ColourEncoder {\n  constructor(options = {}) {\n    this.characterCodes = options.characterCodes || CHARACTER_CODES;\n    this.bitColours = options.bitColours || BIT_COLOURS;\n  }\n\n  get charLength() {\n    return Math.max(\n      ...Object.values(this.characterCodes).map(v => v.toString(3).length)\n    );\n  }\n\n  encode(input, options = {}) {\n    const { length } = options;\n\n    const characters = input.split('');\n\n    const maxBitCount = length - 1;\n    const maxCharacterCount = Math.floor(maxBitCount / this.charLength);\n    if (characters.length > maxCharacterCount) {\n      throw new Error(`Input exceeds max length of ${maxCharacterCount}`);\n    }\n\n    const characterCodes = characters.map(c => {\n      const characterCode = this.characterCodes[c];\n\n      if (!characterCode) {\n        throw new Error(`Cannot resolve unknown character: ${c}. Only A-Z and 0-9 are supported.`);\n      }\n\n      return this._padCharacterCode(characterCode.toString(3));\n    });\n\n    const bits = Array(maxBitCount)\n      .fill()\n      .map((_, index) => characterCodes.join('').split('')[index] || '0');\n\n    const parityBit = bits.reduce((acc, b) => acc + Number(b), 0);\n    bits.push(String(parityBit % 3));\n\n    return bits.map(b => this.bitColours[b]);\n  }\n\n  decode(colours) {\n    const bits = colours.map(c => this._findClosestBit(c));\n\n    const characterBitsCount = bits.length - 1;\n    const characterBits = Array(Math.floor(characterBitsCount / this.charLength))\n      .fill()\n      .map((_, index) => bits.slice(index * this.charLength, (index + 1) * this.charLength))\n      .filter(c => !c.every(b => b === '0'));\n\n    const parityBit = bits.pop();\n    const parityBitCheck = characterBits\n      .map(c => c.reduce((acc, b) => acc + Number(b), 0))\n      .reduce((acc, s) => acc + Number(s), 0);\n\n    if (Number(parityBit) !== parityBitCheck % 3) {\n      throw new Error('Failed to decode invalid data');\n    }\n\n    const characterCodes = characterBits.map(c => parseInt(c.join(''), 3));\n\n    const decoded = characterCodes.map(c => {\n      const [ character ] = Object.entries(this.characterCodes)\n        .find(([ , code ]) => code === c);\n\n      if (!character) {\n        throw new Error(`Failed to resolve character with code ${c}`);\n      }\n\n      return character;\n    }).join('');\n\n    return decoded;\n  }\n\n  _padCharacterCode(characterCode) {\n    const r = [\n      ...Array(this.charLength - characterCode.length).fill('0'),\n      characterCode,\n    ].join('');\n\n    return r;\n  }\n\n  findClosestBitColour(c) {\n    const [{ bit, colour }] = Object.entries(this.bitColours)\n      .map(([ bit, colour ]) => {\n        const distance = this.calculateColourDistance(c, colour);\n\n        return {\n          bit,\n          colour,\n          distance,\n        };\n      })\n      .sort(({ distance: a }, { distance: b }) => a - b);\n\n    return { bit, colour };\n  }\n\n  calculateColourDistance(c1, c2) {\n    const a = Jimp.intToRGBA(c1);\n    const b = Jimp.intToRGBA(c2);\n\n    return Math.pow(b.r - a.r, 2) + Math.pow(b.g - a.g, 2) + Math.pow(b.b - a.b, 2);\n  }\n\n  _findClosestBit(c) {\n    const { bit } = this.findClosestBitColour(c);\n\n    return bit;\n  }\n}\n\nexport default ColourEncoder;\n","import log from './_log';\nimport image from './_image';\nimport ColourEncoder from './_colour-encoder';\n\nexport default {\n  log,\n  image,\n  ColourEncoder,\n};\n"],"sourceRoot":""}